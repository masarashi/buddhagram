<!-- 投稿内容表示 -->

<div class="post__show border">
  <div class="post__show__body">
    <div class="post__show__left__side">
      <% @post.images.each do |image| %>
        <%= image_tag post_image(image), class: "post__image" %>
      <% end %>
    </div>

    <div class="post__show__right__side">
      <div class="post__show__username">
        <%= link_to @post.user do %>
          <% if @post.user.image.attached? %>
            <%= image_tag user_icon(@post.user.image), class: "user__icon" %>
          <% else %>
            <%= image_pack_tag "user-icon.png", class: "user__icon" %>
          <% end %>
        <% end %>
        <%= link_to @post.user.name, @post.user %>
        【<%= link_to @post.spot.name, @post.spot %>】
      </div>

      <div class="post__show__comment">
        <div class="post__show__copy">
          <div>
            <%= render_with_hashtags(@post.content) %>
          </div>
          <div class="post__time">
            <%= @post.created_at %>
          </div>
        </div>
        <% @post.comments.each do |comment| %>
          <div class="post__show__comment__body">
            <div class="comment_user__icon">
              <%= link_to comment.user do %>
                <% if comment.user.image.attached? %>
                  <%= image_tag user_icon(comment.user.image), class: "user__icon" %>
                <% else %>
                  <%= image_pack_tag "user-icon.png", class: "user__icon" %>
                <% end %>
              <% end %>
            </div>
            <div>
              <%= link_to comment.user.name, comment.user, class: "comment_username" %>
              <%= comment.content %><br>
              <div class="comment__time">
                <%= comment.created_at %>
              </div>
            </div>
          </div>
        <% end %>
      </div>

      <%= form_for [@post, @comment], local: true do |f| %>
        <div class="post__show__comment__form">
          <div class="form-group">
            <%= f.label :content, class: "d-none" %>
            <%= f.text_area :content, placeholder: "コメント", class: "form-control comment__textarea" %>
          </div>
          <div>
            <%= f.submit "送信", class: "btn btn-sm btn-secondary comment__btn" %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>

<div class="post__show__footer">
  <% if @post.user == current_user %>
    <%= link_to "編集", edit_post_path, class: "btn btn-sm btn-secondary" %>
    <%= link_to "削除", @post, class: "btn btn-sm btn-outline-danger", method: :delete, data: { confirm: "本当に削除しますか？" } %>
  <% end %>
</div>
