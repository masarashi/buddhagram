<div id='map'></div>

<%# <script>
  let map

  function initMap(){
    geocoder = new google.maps.Geocoder()

    map = new google.maps.Map(document.getElementById('map'), {
      //latが緯度、lngが経度を示します
      center: {lat: 36.578044, lng: 136.648171},
      //数値は0〜21まで指定できます。数値が大きいほど拡大されます
      zoom: 15,
    });

    //positionに指定した座標にピンを表示させます
    marker = new google.maps.Marker({
      position: {lat: 36.578044, lng: 136.648171},
      map: map
    });
  }
</script> %>

<script>
  let map;

  function initMap() {
    // 位置情報を取得
    navigator.geolocation.getCurrentPosition(function (position) {

      LatLng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);

      // 取得した位置情報を中心に表示
      map = new google.maps.Map(document.getElementById('map'), {
        center: LatLng,
        zoom: 15
      });

      marker = new google.maps.Marker({
        position: LatLng,
        map: map
      });
    });
  }
</script>

<script src="https://maps.googleapis.com/maps/api/js?key=<%= Rails.application.credentials.gmap[:api_key] %>&callback=initMap" async defer></script>

<button onclick="initMap();">現在地</button>
